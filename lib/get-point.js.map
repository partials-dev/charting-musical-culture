{"version":3,"sources":["../src/get-point.js"],"names":[],"mappings":";;;;;kBA8BwB,Q;;AA9BxB;;;;AACA;;;;;;AAEA,IAAM,kBAAkB,UAAxB;AACA,IAAM,uBAAuB,UAA7B;;AAEA,SAAS,MAAT,CAAgB,IAAhB,EAAsB;AACpB,8GAGU,eAHV,UAG8B,IAH9B,sBAIU,oBAJV;AAOD;;AAED,SAAS,SAAT,CAAmB,GAAnB,EAAwB,UAAxB,EAAoC,WAApC,EAAiD;AAC/C,MAAI,IAAI,IAAI,OAAJ,CAAY,UAAZ,CAAR;AACA,MAAI,KAAK,CAAC,CAAV,EAAa,OAAO,EAAP;AACb,MAAI,IAAI,IAAI,OAAJ,CAAY,WAAZ,EAAyB,IAAI,CAA7B,CAAR;AACA,MAAI,KAAK,CAAC,CAAV,EAAa,OAAO,EAAP;AACb,SAAO,IAAI,MAAJ,CAAW,IAAI,CAAf,EAAkB,IAAI,CAAJ,GAAQ,CAA1B,CAAP;AACD;;AAED,SAAS,UAAT,CAAoB,GAApB,EAAyB;AACrB,MAAM,cAAc,UAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,EAAyB,KAAzB,CAA+B,GAA/B,EAAoC,GAApC,CAAwC,UAAxC,CAApB;AACA,MAAM,QAAQ,EAAE,MAAM,YAAY,CAAZ,CAAR,EAAwB,KAAK,YAAY,CAAZ,CAA7B,EAAd;AACA,SAAO,KAAP;AACH;;AAEc,SAAS,QAAT,CAAkB,IAAlB,EAAwB,EAAxB,EAA4B;AACzC,MAAM,MAAM,sBAAI,WAAJ,CAAgB,OAAO,KAAK,GAAZ,CAAhB,CAAZ;AACA,yBAAQ,GAAR,EAAa,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAoB;AAC/B,QAAM,OAAO,sBAAI,qBAAJ,CAA0B,IAA1B,EAAgC,CAAhC,CAAb;AACA,QAAM,QAAQ,WAAW,IAAX,CAAd;AACA,OAAG,KAAH;AACD,GAJD;AAKD","file":"get-point.js","sourcesContent":["import wdk from 'wikidata-sdk'\nimport request from 'request'\n\nconst musicBrainzIdIs = 'wdt:P982'\nconst coordinateLocationIs = 'wdt:P625'\n\nfunction sparql(mbid) {\n  return `\n  PREFIX wdt: <http://www.wikidata.org/prop/direct/>\n  SELECT ?coordinate WHERE {\n    ?area ${musicBrainzIdIs} \"${mbid}\".\n    ?area ${coordinateLocationIs} ?coordinate.\n  }\n  `\n}\n\nfunction getSubStr(str, firstDelim, secondDelim) {\n  var a = str.indexOf(firstDelim)\n  if (a == -1) return ''\n  var b = str.indexOf(secondDelim, a + 1)\n  if (b == -1) return ''\n  return str.substr(a + 1, b - a - 1)\n}\n\nfunction parsePoint(str) {\n    const coordinates = getSubStr(str, '(', ')').split(' ').map(parseFloat)\n    const point = { long: coordinates[0], lat: coordinates[1] }\n    return point\n}\n\nexport default function getPoint(area, cb) {\n  const url = wdk.sparqlQuery(sparql(area.gid))\n  request(url, (err, res, body) => {\n    const data = wdk.simplifySparqlResults(body)[0]\n    const point = parsePoint(data)\n    cb(point)\n  })\n}\n"]}